<?xml version="1.0" encoding="utf-8"?>
<scripts>

  <!-- chained pubscripts -->
  <pubscript id="filterpivot" type="plugin" multi="yes" input="pivot" output="pivot">
    <name>Filtrage du pivot</name>
    <plugin>filterpivot</plugin>
    <parameters>
      <parameter name="filter" label="Filtre de pivot" 
		 type="filelist" dir="kolekti/publication-templates/filterpivot/xsl" ext="xsl"/>
    </parameters>
  </pubscript>
  
  <pubscript id="princexml_multi" type="shell" multi="yes" input="pivot" output="pdf">
    <name>Générer pdf avec PrinceXML</name>
    <cmd>prince "_PIVOT_" -s "_SRCDIR_/kolekti/publication-templates/princexml/css/_CSS_.css" --baseurl "_SRCDIR_/." -o "_PUBDIR_/_PUBNAME_.pdf"</cmd>
    <link name="_PUBNAME_.pdf" type="pdf" ref="_PUBURI_/_PUBNAME_.pdf"/>
    <parameters>
      <parameter name="CSS" label="Feuille de style" 
		 type="filelist" dir="kolekti/publication-templates/princexml/css" ext="css"/>
    </parameters>
  </pubscript>

  <pubscript id="princexml_nbpage" type="plugin" multi="yes" input="pivot" output="pdf">
    <name>Générer pdf avec PrinceXML 2 passes (comptage pages)</name>
    <plugin>princexml_nbpage</plugin>
    <cmd>prince "_INCOPY_" -s "_SRCDIR_/kolekti/publication-templates/princexml/css/_CSS_.css" --baseurl "_SRCDIR_/." -o "_PUBDIR_/_PUBNAME_.pdf"</cmd>
    <link name="_PUBNAME_.pdf" type="pdf" ref="_PUBURI_/_PUBNAME_.pdf"/>
    <parameters>
      <parameter name="CSS" label="Feuille de style" 
		 type="filelist" dir="kolekti/publication-templates/princexml/css" ext="css"/>
    </parameters>
  </pubscript>

  
  <pubscript id="ExportPublicationToFolder" multi="yes" type="plugin">
    <name>Copier la publication vers un dossier</name>
    <plugin>ExportPublicationToFolder</plugin>
    <parameters>
      <parameter name="destination" label="Chemin du dossier destination" 
		 type="text" />
    </parameters>
  </pubscript>

  <pubscript id="WebHelp5_multi" multi="yes" type="plugin" input="pivot" output="webhelp">
    <name>WebHelp5 (Aide en ligne html5)</name>
    <plugin>WebHelp5</plugin>
    <parameters>
      <parameter name="template" label="Directives" 
         type="filelist" 
         dir="kolekti/publication-templates/WebHelp5"
         ext="xht"/>

      <parameter name="css" label="Feuille de style" 
         type="filelist" 
         dir="kolekti/publication-templates/WebHelp5/styles" 
         ext="css"
         copytopub="usercss"/>

      <parameter name="zip" label="Créer zip" 
         type="boolean"/>

      <parameter name="labels" 
         type="resource" 
         dir="sources/{LANG}/variables"
         file="WebHelp5_labels"
	 ext="xml"
         />
      <parameter name="generate" 
         type="resource" 
         dir="kolekti/publication-templates/WebHelp5/xsl"
	 onfail="silent"
         />
    </parameters>
  </pubscript>

  
  <pubscript id="serializepdf" type="plugin" multi="yes" input="pdf" output="pdf">
    <name>Optimiser le pdf pour le web</name>
    <plugin>serializepdf</plugin>
    <cmd>gs -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -dFastWebView=true -sOutputFile=_PUBDIR_/_PUBNAME_.pdf _INCOPY_</cmd>
    <link name="_PUBNAME_.pdf" type="pdf" ref="_PUBURI_/_PUBNAME_.pdf"/>
    <parameters/>
  </pubscript>

  <!-- single scripts -->
  <pubscript id="princexml" type="shell">
    <name>Générer pdf avec PrinceXML</name>
    <cmd>prince "_PIVOT_" -s "_SRCDIR_/kolekti/publication-templates/princexml/css/_CSS_.css" --baseurl "_SRCDIR_/." -o "_PUBDIR_/_PUBNAME_.pdf"</cmd>
    <link name="_PUBNAME_.pdf" type="pdf" ref="_PUBURI_/_PUBNAME_.pdf"/>
    <parameters>
      <parameter name="CSS" label="Feuille de style" 
		 type="filelist" dir="kolekti/publication-templates/princexml/css" ext="css"/>
      <parameter name="pivot_filter" label="Filtre de pivot" 
		 type="filelist" dir="kolekti/publication-templates/princexml/filters" ext="xsl"/>
    </parameters>
  </pubscript>

  <pubscript id="fop" type="shell">
    <name>Générer pdf avec Apache fop</name>
<!--
    <cmd>fop -c _APPDIR_/plugins/_fop/fop.xconf -xml "_PIVOT_" -xsl "_SRCDIR_/kolekti/publication-templates/fop/_XSL_.xsl" -param baseuri "_BASEURI_" -pdf "_PUBDIR_/_PUBNAME_.pdf"</cmd>
-->

 <cmd>xsltproc --novalid --stringparam baseuri "_BASEURI_" "_SRCDIR_/kolekti/publication-templates/fop/_XSL_.xsl" "_PIVOT_" |fop -c _APPDIR_/plugins/_fop/fop.xconf -fo - -pdf "_PUBDIR_/_PUBNAME_.pdf"</cmd>

    <link name="_PUBNAME_.pdf" ref="_PUBURI_/_PUBNAME_.pdf" type="pdf"/>
    <parameters>
      <parameter name="XSL" label="Feuille de style" 
		 type="filelist" dir="kolekti/publication-templates/fop" ext="xsl"/>
    </parameters>
  </pubscript>

  <pubscript id="WebHelp5" type="plugin">
    <name>WebHelp5 (Aide en ligne html5)</name>
    <plugin>WebHelp5</plugin>
    <parameters>
      <parameter name="template" label="Directives" 
         type="filelist" 
         dir="kolekti/publication-templates/WebHelp5"
         ext="xht"/>

      <parameter name="css" label="Feuille de style" 
         type="filelist" 
         dir="kolekti/publication-templates/WebHelp5/styles" 
         ext="css"
         copytopub="usercss"/>

      <parameter name="pivot_filter" label="Filtre de pivot" 
		 type="filelist"
		 dir="kolekti/publication-templates/WebHelp5/filters"
		 ext="xsl"/>

      <parameter name="zip" label="Créer zip" 
         type="boolean"/>

      <parameter name="labels" 
         type="resource" 
         dir="sources/{LANG}/variables"
         file="WebHelp5_labels"
	 ext="xml"
         />
      <parameter name="generate" 
         type="resource" 
         dir="kolekti/publication-templates/WebHelp5/xsl"
	 onfail="silent"
         />
    </parameters>
  </pubscript>




</scripts> 
