(function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){function j(a){"object"==typeof a&&(this.minChars=a.minChars,this.style=a.style,this.showToken=a.showToken,this.delay=a.delay,this.wordsOnly=a.wordsOnly);null==this.style&&(this.style=k);null==this.minChars&&(this.minChars=l);null==this.delay&&(this.delay=m);null==this.wordsOnly&&(this.wordsOnly=n);this.overlay=
this.timeout=null}function g(a){var c=a.state.matchHighlighter;clearTimeout(c.timeout);c.timeout=setTimeout(function(){h(a)},c.delay)}function h(a){a.operation(function(){var c=a.state.matchHighlighter;c.overlay&&(a.removeOverlay(c.overlay),c.overlay=null);if(!a.somethingSelected()&&c.showToken){for(var d=!0===c.showToken?/[\w$]/:c.showToken,b=a.getCursor(),f=a.getLine(b.line),e=b=b.ch;b&&d.test(f.charAt(b-1));)--b;for(;e<f.length&&d.test(f.charAt(e));)++e;b<e&&a.addOverlay(c.overlay=i(f.slice(b,
e),d,c.style))}else if(d=a.getCursor("from"),f=a.getCursor("to"),d.line==f.line){if(b=c.wordsOnly){a:if(null!==a.getRange(d,f).match(/^\w+$/)){if(0<d.ch&&(b={line:d.line,ch:d.ch-1},b=a.getRange(b,d),null===b.match(/\W/))){b=!1;break a}if(f.ch<a.getLine(d.line).length&&(b={line:f.line,ch:f.ch+1},b=a.getRange(f,b),null===b.match(/\W/))){b=!1;break a}b=!0}else b=!1;b=!b}b||(d=a.getRange(d,f).replace(/^\s+|\s+$/g,""),d.length>=c.minChars&&a.addOverlay(c.overlay=i(d,!1,c.style)))}})}function i(a,c,d){return{token:function(b){if(b.match(a)&&
(!c||(!b.start||!c.test(b.string.charAt(b.start-1)))&&(b.pos==b.string.length||!c.test(b.string.charAt(b.pos)))))return d;b.next();b.skipTo(a.charAt(0))||b.skipToEnd()}}}var l=2,k="matchhighlight",m=100,n=!1;e.defineOption("highlightSelectionMatches",!1,function(a,c,d){if(d&&d!=e.Init){(d=a.state.matchHighlighter.overlay)&&a.removeOverlay(d);clearTimeout(a.state.matchHighlighter.timeout);a.state.matchHighlighter=null;a.off("cursorActivity",g)}if(c){a.state.matchHighlighter=new j(c);h(a);a.on("cursorActivity",
g)}})});