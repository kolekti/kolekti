(function(c){"object"==typeof exports&&"object"==typeof module?c(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],c):c(CodeMirror)})(function(c){c.registerHelper("fold","brace",function(d,a){function f(g){for(var b=a.ch,f=0;;)if(b=0>=b?-1:h.lastIndexOf(g,b-1),-1==b){if(1==f)break;f=1;b=h.length}else{if(1==f&&b<a.ch)break;e=d.getTokenTypeAt(c.Pos(i,b+1));if(!/^(comment|string)/.test(e))return b+1;b-=1}}var i=a.line,h=d.getLine(i),g,e,o="{",p="}";
g=f("{");null==g&&(o="[",p="]",g=f("["));if(null!=g){var q=1,r=d.lastLine(),l,n,j=i;a:for(;j<=r;++j)for(var k=d.getLine(j),b=j==i?g:0;;){var m=k.indexOf(o,b),b=k.indexOf(p,b);0>m&&(m=k.length);0>b&&(b=k.length);b=Math.min(m,b);if(b==k.length)break;if(d.getTokenTypeAt(c.Pos(j,b+1))==e)if(b==m)++q;else if(!--q){l=j;n=b;break a}++b}if(!(null==l||i==l&&n==g))return{from:c.Pos(i,g),to:c.Pos(l,n)}}});c.registerHelper("fold","import",function(d,a){function f(e){if(e<d.firstLine()||e>d.lastLine())return null;
var a=d.getTokenAt(c.Pos(e,1));/\S/.test(a.string)||(a=d.getTokenAt(c.Pos(e,a.end+1)));if("keyword"!=a.type||"import"!=a.string)return null;for(var g=e,e=Math.min(d.lastLine(),e+10);g<=e;++g){var f=d.getLine(g).indexOf(";");if(-1!=f)return{startCh:a.end,end:c.Pos(g,f)}}}var a=a.line,i=f(a),h;if(!i||f(a-1)||(h=f(a-2))&&h.end.line==a-1)return null;for(h=i.end;;){var g=f(h.line+1);if(null==g)break;h=g.end}return{from:d.clipPos(c.Pos(a,i.startCh+1)),to:h}});c.registerHelper("fold","include",function(d,
a){function f(a){if(a<d.firstLine()||a>d.lastLine())return null;var e=d.getTokenAt(c.Pos(a,1));/\S/.test(e.string)||(e=d.getTokenAt(c.Pos(a,e.end+1)));if("meta"==e.type&&"#include"==e.string.slice(0,8))return e.start+8}var a=a.line,i=f(a);if(null==i||null!=f(a-1))return null;for(var h=a;null!=f(h+1);)++h;return{from:c.Pos(a,i+1),to:d.clipPos(c.Pos(h))}})});