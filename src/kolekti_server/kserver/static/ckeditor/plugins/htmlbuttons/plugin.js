CKEDITOR.plugins.add("htmlbuttons",{requires:["menubutton"],init:function(c){function k(a){return{exec:function(c){var g=a.html,b=c.getSelection(),e=b&&b.getSelectedText();if(-1!=g.indexOf("> </")&&e){for(var e="address article aside audio blockquote canvas dd div dl fieldset figcaption figure figcaption footer form h1 h2 h3 h4 h5 h6 header hgroup hr noscript ol output p pre section table tfoot ul video".split(" "),d=b.getRanges(),l=new CKEDITOR.dom.element("div"),b=0,f=d.length;b<f;++b){var i=d[b],
h=i.createBookmark2();l.append(i.cloneContents());i.moveToBookmark(h);i.select()}d=l.getHtml();for(b=0;b<e.length;b++)d=d.replace(RegExp("(<"+e[b]+"[^>]*>|</"+e[b]+">)","gi"),"");g=g.replace("> </",">"+d+"</")}c.insertHtml(g)}}}function n(a){for(var f=a.items,g={},b=0;b<f.length;b++){var e=f[b],d=e.name;c.addCommand(d,k(e));g[d]={label:e.title,command:d,group:a.name,role:"menuitem"}}c.addMenuGroup(a.name,1);c.addMenuItems(g);return{label:a.title,icon:m.path+a.icon,toolbar:a.toolbar||"insert",onMenu:function(){var a=
{},b;for(b in g)a[b]=CKEDITOR.TRISTATE_OFF;return a}}}var h=c.config.htmlbuttons,m=this;if(h)for(var j=0;j<h.length;j++){var a=h[j],f=a.name;a.html?(c.addCommand(f,k(a)),c.ui.addButton(f,{label:a.title,command:f,toolbar:a.toolbar||"insert",icon:m.path+a.icon})):(a=n(a),c.ui.add(f,CKEDITOR.UI_MENUBUTTON,a))}}});
CKEDITOR.config.htmlbuttons=[{name:"button1",icon:"icon1.png",html:'<a href="http://www.google.com"> </a>',title:"A link to Google"},{name:"button2",icon:"icon2.png",html:'<table style="min-width:200px"><tr><td> </td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr></table>',title:"A simple table"},{name:"button3",icon:"icon3.png",html:"<ol><li>Item 1 <ol><li>Sub item 1</li><li>Sub item 2</li></ol></li></ol>",title:"A nested list"},{name:"divs",icon:"puzzle.png",title:"Insert items",items:[{name:"button4",
icon:"icon1.png",html:'<div class="wrapper"><ol><li>Item 1</li></ol></div>',title:"A div with a list inside"},{name:"button5",icon:"icon2.png",html:'<p class="heading"> </p>',title:"A paragraph with a class"}]}];